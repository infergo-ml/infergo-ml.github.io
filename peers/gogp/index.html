<!DOCTYPE html>
<html class="nojs" lang="en-GB" dir="ltr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>GoGP – Infergo – Go programs that learn</title>

<meta name="created" content="0001-01-01T00:00:00+0000">
<meta name="modified" content="0001-01-01T00:00:00+0000">
<meta name="author" content="David Tolpin">
<meta name="contact" content="david.tolpin@gmail.com">
<meta property="og:site_name" content="Infergo – Go programs that learn">
<meta property="og:title" content="GoGP">
<meta property="og:url" content="https://infergo.org/peers/gogp/">
<meta property="og:type" content="article">
<meta property="og:image" content="https://infergo.org/apple-touch-icon.png">
<meta name="generator" content="Hugo 0.152.2">



<link rel="canonical" href="https://infergo.org/peers/gogp/">

<link rel="apple-touch-icon" href="/apple-touch-icon.png">

<link rel="stylesheet" href="/css/styles.e0152089efa947ccfc2382287415b113d67f06fc5da842a0d9617c8eda082ef8.css">
<link rel="stylesheet" href="/css/mobilemenu.295c7ca420e20bb22a98ef9b836cdd291aec4bac9f10e6369bd3ef17f539a522.css" media="screen">
<link rel="stylesheet" href="/css/print.c9925dbab6fd256f753b0319c569e85f28a89b8cbd71238bde2452f74dcdf761.css" media="print">

<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "GoGP",
    "datePublished": "0001-01-01T00:00:00Z",
    "dateModified": "0001-01-01T00:00:00Z",
    "url" : "https://infergo.org/peers/gogp/",
    
    "image" : "https://infergo.org/apple-touch-icon.png",
    "author": {
      "@type": "Person",
      "name": "David Tolpin"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://infergo.org/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Infergo – Go programs that learn",
      "logo" : {
        "@type": "ImageObject",
        "url": "https://infergo.org/apple-touch-icon.png"
      },
      "url": "https://infergo.org/"
    }
  }
</script>

<script>
(()=>{(function(){document.querySelector("html").classList.replace("nojs","js")})();})();

</script>

<script defer src="/js/mobilemenu.7ce1f75fd1d49cd683a008352ad9001f800349629be01d531a19c02b5a84817b.js"></script>
<script defer src="/js/script.f2979a93a325fecf9605263bd141398a311c8e23388ed7dcff74f92f7e632866.js"></script>






</head>

<body class="single-page">
<div class="page layout__page layout__sidebar-second">
<header class="header layout__header">
<a href="/" title="Home" rel="home" class="header__logo">
<img src="/images/logo.png" width="64" alt="Home" class="header__logo-image">
</a>
<h1 class="header__site-name">
<a href="/" title="Home" class="header__site-link" rel="home"><span>Infergo – Go programs that learn</span></a>
</h1>
<div class="region header__region">
</div>
</header>

<nav class="main-menu mx--xs layout__navigation" aria-label="Main menu">
<ul class="flex-inline mx--0">
<li><a href="/"><span>Home</span></a></li>
<li><a href="/start/"><span>Getting started</span></a></li>
<li><a href="/guide/"><span>Guide</span></a></li>
<li><a href="/examples/"><span>Examples</span></a></li>
<li><a href="/news/"><span>News</span></a></li>
<li><a href="/peers/" aria-current="page"><span>Peers</span></a></li>
<li><a href="/team/"><span>Team</span></a></li>
</ul>
</nav>
<div class="mobile-nav" dir="ltr" hidden>
  <div class="mobile-nav__cover"></div>
  <button class="mobile-nav__toggle button" aria-expanded="false" aria-controls="sheet">
    Menu
    <svg class="mobile-nav__hamburger" viewBox="0 0 100 100" focusable="false" aria-hidden="true">
      <rect width="80" height="12" x="10" y="20" rx="5"></rect>
      <rect width="80" height="12" x="10" y="45" rx="5"></rect>
      <rect width="80" height="12" x="10" y="70" rx="5"></rect>
    </svg>
  </button>
  <div class="mobile-nav__sheet link-inverted link-nav" id="sheet" aria-hidden="true">
    <div class="mobile-nav__region"></div>
    <nav class="mobile-nav__main-menu" aria-label="Main menu">
    <ul class="mobile-nav__navbar">
    <li><a href="/"><span>Home</span></a></li>
    <li><a href="/start/"><span>Getting started</span></a></li>
    <li><a href="/guide/"><span>Guide</span></a></li>
    <li><a href="/examples/"><span>Examples</span></a></li>
    <li><a href="/news/"><span>News</span></a></li>
    <li><a href="/peers/" aria-current="page"><span>Peers</span></a></li>
    <li><a href="/team/"><span>Team</span></a></li>
    </ul>
    </nav>
  </div>
</div>
<main class="main layout__main">
<article class="single-view single-view--peers">
<header>
<h1 class="title mb--xxs">GoGP</h1>
<div class="submitted meta">
<span class="author" itemprop="author">David Tolpin</span>

</div>
</header>

<p><a href="http://bitbucket.org/dtolpin/gogp">GoGP</a> is a
library for probabilistic programming around Gaussian processes.
It uses <!-- raw HTML omitted -->Infergo<!-- raw HTML omitted --> for automatic
differentiation and inference.</p>
<p>GoGP is built around a dual view on the Gaussian process</p>
<ul>
<li>as a stochastic process,</li>
<li>as a probabilistic model with respect to kernel.</li>
</ul>
<h2 id="gaussian-process-instance">Gaussian process instance</h2>
<p><a href="https://pkg.go.dev/bitbucket.org/dtolpin/gogp/gp#GP"><code>GP</code></a>, the Gaussian process type, encapsulates similarity and
noise kernels, their parameters, and observation inputs and
outputs:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#60a0b0;font-style:italic">// Type GP is the barebone implementation of GP.</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>GP<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>NDim<span style="color:#bbb">                   </span><span style="color:#902000">int</span><span style="color:#bbb">       </span><span style="color:#60a0b0;font-style:italic">// number of dimensions</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>Simil,<span style="color:#bbb"> </span>Noise<span style="color:#bbb">           </span>Kernel<span style="color:#bbb">    </span><span style="color:#60a0b0;font-style:italic">// kernels</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>ThetaSimil,<span style="color:#bbb"> </span>ThetaNoise<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic">// kernel parameters</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>X<span style="color:#bbb"> </span>[][]<span style="color:#902000">float64</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic">// inputs</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>Y<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span><span style="color:#bbb">   </span><span style="color:#60a0b0;font-style:italic">// outputs</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>Parallel<span style="color:#bbb"> </span><span style="color:#902000">bool</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic">// when true, covariances are computed in parallel</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div>
<p>Public methods defined on <code>GP</code> fall into two groups: Gaussian
process fitting and prediction, on one hand, and
probabilistic model interface, on the other hand.</p>
<h3 id="gaussian-process-methods">Gaussian process methods</h3>
<p><code>Absorb</code> updates <code>GP</code> with observations, <code>Produce</code> returns
predicted outputs for unseen inputs.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(<span style="color:#666">*</span>GP)<span style="color:#bbb"> </span><span style="color:#06287e">Absorb</span>(x<span style="color:#bbb"> </span>[][]<span style="color:#902000">float64</span>,<span style="color:#bbb"> </span>y<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(<span style="color:#666">*</span>GP)<span style="color:#bbb"> </span><span style="color:#06287e">Produce</span>(x<span style="color:#bbb"> </span>[][]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span>(mu,<span style="color:#bbb"> </span>sigma<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)</span></span></code></pre></div>
<p>When kernel parameters are fixed (known or learned), <code>Absorb</code>
and <code>Produce</code> are all that is needed for posterior Gaussian
process inference.</p>
<h3 id="probabilistic-model-methods">Probabilistic model methods</h3>
<p><code>Observe</code> and <code>Gradient</code> turn a <code>GP</code> instance into an elemental
Infergo model (that is, a model with supplied gradient). The
model can be passed to inference algorithms or used within
another model.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(<span style="color:#666">*</span>GP)<span style="color:#bbb"> </span><span style="color:#06287e">Observe</span>(x<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span><span style="color:#902000">float64</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(<span style="color:#666">*</span>GP)<span style="color:#bbb"> </span><span style="color:#06287e">Gradient</span>()<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic">// `elemental&#39; model</span></span></span></code></pre></div>
<p>If the length of <code>x</code> is equal to the number of kernel hyperparameters
(<code>Simil.NTheta() + Noise.NTheta()</code>) then the gradient of
marginal likelihood  is computed with respect to kernel
hyperparameters only. Observations must be provided in the fields
of the GP instance. Otherwise, if the length of <code>x</code> is greater
than the number of parameters, the rest of <code>x</code> is interpreted
as observations. In the latter case, the gradient is computed
with respect to both kernel hyperparameters and observations.</p>
<h3 id="hyperparameter-priors">Hyperparameter priors</h3>
<p>Type
<a href="https://pkg.go.dev/bitbucket.org/dtolpin/gogp/gp#Model"><code>Model</code></a> is a wrapper model combining a <code>GP</code> instance and
priors on hyperparameters into an elemental Infergo model.
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>Model<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#666">*</span>GP<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>Priors<span style="color:#bbb"> </span>model.Model<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div>
<code>GP</code> holds a Gaussian process instance and <code>Priors</code>
holds an instance of the model expressing beliefs about
hyperparameters.</p>
<h2 id="kernels">Kernels</h2>
<p>There are two kernel kinds:</p>
<ul>
<li>similarity kernel;</li>
<li>noise kernel.</li>
</ul>
<p>Both kinds must satisfy the
<a href="https://pkg.go.dev/bitbucket.org/dtolpin/gogp/gp#Kernel"><code>Kernel</code></a>
interface:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>Kernel<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">interface</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#06287e">Observe</span>([]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span><span style="color:#902000">float64</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#06287e">NTheta</span>()<span style="color:#bbb"> </span><span style="color:#902000">int</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div>
<p>The <code>Observe</code> method computes the variance or covariance,
the <code>NTheta</code> method returns the number of kernel parameters.</p>
<p>A similarity (or covariance) kernel receives concanetation
of kernel parameters and coordinates of two points. A noise
kernel receives concatenation of kernel parameters and
coordinates of a single point. Here is an example implementation
of the RBF (or normal) kernel:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>RBF<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span>{}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(RBF)<span style="color:#bbb"> </span><span style="color:#06287e">Observe</span>(x<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span><span style="color:#902000">float64</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>l,<span style="color:#bbb"> </span>xa,<span style="color:#bbb"> </span>xb<span style="color:#bbb"> </span><span style="color:#666">:=</span><span style="color:#bbb"> </span>x[<span style="color:#40a070">0</span>],<span style="color:#bbb"> </span>x[<span style="color:#40a070">1</span>],<span style="color:#bbb"> </span>x[<span style="color:#40a070">2</span>]<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>d<span style="color:#bbb"> </span><span style="color:#666">:=</span><span style="color:#bbb"> </span>(xa<span style="color:#bbb"> </span><span style="color:#666">-</span><span style="color:#bbb"> </span>xb)<span style="color:#bbb"> </span><span style="color:#666">/</span><span style="color:#bbb"> </span>l<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span>math.<span style="color:#06287e">Exp</span>(<span style="color:#666">-</span>d<span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span>d<span style="color:#bbb"> </span><span style="color:#666">/</span><span style="color:#bbb"> </span><span style="color:#40a070">2</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(RBF)<span style="color:#bbb"> </span><span style="color:#06287e">NTheta</span>()<span style="color:#bbb"> </span><span style="color:#902000">int</span><span style="color:#bbb"> </span>{<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#40a070">1</span><span style="color:#bbb"> </span>}</span></span></code></pre></div>
<p>Frequently used primitive kernels are
<a href="https://pkg.go.dev/bitbucket.org/dtolpin/gogp/kernel">included</a>
in the library.</p>
<h2 id="case-studies">Case studies</h2>
<p>GoGP includes case
<a href="http://bitbucket.org/tolpin/gogp/src/master/tutorial">studies</a>,
illustrating, on simple examples, common patterns of GoGP use.
We briefly summarize here some of the case studies.</p>
<h3 id="basic-usage">Basic usage</h3>
<p>In the basic case, similar to that supported by many Gaussian
process libraries, a <code>GP</code> instance directly serves as the model
for inference on hyperparameters (or the hyperparameters can be
just fixed).</p>
<p>The library user specifies the kernel:</p>
<p><div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>Basic<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span>{}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(Basic)<span style="color:#bbb"> </span><span style="color:#06287e">Observe</span>(x<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span><span style="color:#902000">float64</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span>x[<span style="color:#40a070">0</span>]<span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span>kernel.Normal.<span style="color:#06287e">Observe</span>(x[<span style="color:#40a070">1</span>:])<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(Basic)<span style="color:#bbb"> </span><span style="color:#06287e">NTheta</span>()<span style="color:#bbb"> </span><span style="color:#902000">int</span><span style="color:#bbb"> </span>{<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#40a070">2</span><span style="color:#bbb"> </span>}</span></span></code></pre></div>
and initializes <code>GP</code> with a kernel instance:
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>gp<span style="color:#bbb"> </span><span style="color:#666">:=</span><span style="color:#bbb"> </span><span style="color:#666">&amp;</span>gp.GP{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>NDim:<span style="color:#bbb">  </span><span style="color:#40a070">1</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Simil:<span style="color:#bbb"> </span>Basic{},<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div></p>
<p>MLE inference on hyperparameters and prediction can then be performed
through library functions.</p>
<h3 id="priors-on-hyperparameters">Priors on hyperparameters</h3>
<p>If priors on hyperparameters are to be specified, the library
user provides both the kernel and the prior beliefs:
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#60a0b0;font-style:italic">// Similarity kernel</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>Simil<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span>{}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(Simil)<span style="color:#bbb"> </span><span style="color:#06287e">Observe</span>(x<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span><span style="color:#902000">float64</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#007020;font-weight:bold">const</span><span style="color:#bbb"> </span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>c<span style="color:#bbb"> </span>=<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">iota</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic">// trend scale</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>l<span style="color:#bbb">        </span><span style="color:#60a0b0;font-style:italic">// trend length scale</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>xa<span style="color:#bbb">        </span><span style="color:#60a0b0;font-style:italic">// first point</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>xb<span style="color:#bbb">        </span><span style="color:#60a0b0;font-style:italic">// second point</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span>x[c]<span style="color:#666">*</span>kernel.Matern52.<span style="color:#06287e">Cov</span>(x[l],<span style="color:#bbb"> </span>x[xa],<span style="color:#bbb"> </span>x[xb])<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(Simil)<span style="color:#bbb"> </span><span style="color:#06287e">NTheta</span>()<span style="color:#bbb"> </span><span style="color:#902000">int</span><span style="color:#bbb"> </span>{<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#40a070">2</span><span style="color:#bbb"> </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#60a0b0;font-style:italic">// Noise kernel</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>Noise<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span>{}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(Noise)<span style="color:#bbb"> </span><span style="color:#06287e">Observe</span>(x<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span><span style="color:#902000">float64</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#40a070">0.01</span><span style="color:#bbb"> </span><span style="color:#666">*</span><span style="color:#bbb"> </span>kernel.UniformNoise.<span style="color:#06287e">Observe</span>(x)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(Noise)<span style="color:#bbb"> </span><span style="color:#06287e">NTheta</span>()<span style="color:#bbb"> </span><span style="color:#902000">int</span><span style="color:#bbb"> </span>{<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span><span style="color:#40a070">1</span><span style="color:#bbb"> </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#60a0b0;font-style:italic">// Hyperparameter priors</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>Priors<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span>{}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(<span style="color:#666">*</span>Priors)<span style="color:#bbb"> </span><span style="color:#06287e">Observe</span>(x<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span><span style="color:#902000">float64</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span>Normal.<span style="color:#06287e">Logps</span>(<span style="color:#40a070">1</span>,<span style="color:#bbb"> </span><span style="color:#40a070">1</span>,<span style="color:#bbb"> </span>x<span style="color:#666">...</span>)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div>
A <code>Model</code> instance is then used to combine them:
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>m<span style="color:#bbb"> </span><span style="color:#666">:=</span><span style="color:#bbb"> </span><span style="color:#666">&amp;</span>gp.Model{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>GP:<span style="color:#bbb"> </span><span style="color:#666">&amp;</span>gp.GP{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>NDim:<span style="color:#bbb">     </span><span style="color:#40a070">1</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>Simil:<span style="color:#bbb">    </span>Simil,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>Noise:<span style="color:#bbb">    </span>Noise,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>},<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>Priors:<span style="color:#bbb"> </span><span style="color:#666">&amp;</span>Priors{},<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div>
Maximum <em>a posteriori</em> hyperparameter assignments are
affected by both the data and the priors.</p>
<h3 id="uncertain-observation-inputs">Uncertain observation inputs</h3>
<p>When observation inputs are uncertain, beliefs about inputs can
be specified, and the log-likelihood gradient can be computed
with respect to both hyperparameters and observation inputs. For
example, in a time series, one can assume that observation
inputs come from a renewal process and let the inputs move
relative to each other. Then, forecasting can be performed
relative to posterior observation inputs.</p>
<h3 id="non-gaussian-noise">Non-Gaussian noise</h3>
<p>In basic usage, the observation noise is assumed to be Gaussian.
This usage is supported by initializing <code>GP</code> with a noise
kernel, along with a similarity kernel. When the noise is not
Gaussian, an analytical solution for posterior Gaussian process
inference does not always exist. However, non-Gaussian noise is
straightforwardly supported by GoGP through supplying a
model for beliefs on observation outputs:
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#007020;font-weight:bold">type</span><span style="color:#bbb"> </span>Noise<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">struct</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>Y<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span><span style="color:#bbb"> </span><span style="color:#60a0b0;font-style:italic">// noisy outputs</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#007020;font-weight:bold">func</span><span style="color:#bbb"> </span>(m<span style="color:#bbb"> </span><span style="color:#666">*</span>Noise)<span style="color:#bbb"> </span><span style="color:#06287e">Observe</span>(x<span style="color:#bbb"> </span>[]<span style="color:#902000">float64</span>)<span style="color:#bbb"> </span>(lp<span style="color:#bbb"> </span><span style="color:#902000">float64</span>){<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#60a0b0;font-style:italic">// Laplacian noise</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#007020;font-weight:bold">for</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#666">:=</span><span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">range</span><span style="color:#bbb"> </span>m.Y<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">		</span>lp<span style="color:#bbb"> </span><span style="color:#666">+=</span><span style="color:#bbb"> </span>Expon.<span style="color:#06287e">Logp</span>(<span style="color:#40a070">1</span><span style="color:#666">/</span>math.<span style="color:#06287e">Exp</span>(x[<span style="color:#40a070">0</span>]),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">			</span>math.<span style="color:#06287e">Abs</span>(m.Y[i]<span style="color:#666">-</span>x[<span style="color:#40a070">1</span><span style="color:#666">+</span>i]))<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#007020;font-weight:bold">return</span><span style="color:#bbb"> </span>lp<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}</span></span></code></pre></div></p>


</article>
</main>


<aside class="sidebar layout__second-sidebar">
<nav class="menu">
<p class="title"><strong><a href="/peers/" aria-current="page">Peers</a></strong></p>
<ul>
<li><a href="/peers/gogp/" aria-current="page">GoGP</a></li>
</ul>
</nav>
<nav class="menu">
<p class="title"><strong><a href="/news/">News</a></strong></p>
<ul>
<li><a href="/news/v1.2.2/">infergo v1.2.2</a></li>
<li><a href="/news/gogp-v1.0.1/">gogp v1.0.1</a></li>
<li><a href="/news/v1.0.1/">infergo v1.0.1</a></li>
<li><a href="/news/gogp/">gogp v0.1.0</a></li>
<li><a href="/news/v0.7.0/">infergo v0.7.0</a></li>
<li><a href="/news/v0.6.1/">infergo v0.6.1</a></li>
<li><a href="/news/v0.5.0/">infergo v0.5.0</a></li>
<li><a href="/news/tale-of-goids/">The Tale of GoIDs</a></li>
<li><a href="/news/v0.3.0/">infergo v0.3.0</a></li>
<li><a href="/news/v0.2.2/">infergo v0.2.2</a></li>
<li><a href="/news/v0.2.1/">infergo v0.2.1</a></li>
<li><a href="/news/why/">Why infergo</a></li>
</ul>
</nav>
</aside>
<footer class="footer layout__footer mt--l">
<p><span>© Infergo – Go programs that learn</span></p>

<p>Powered by <a href="https://gohugo.io/">Hugo</a> and the <a href="https://github.com/frjo/hugo-theme-zen">Zen theme</a>.</p>

</footer>

</div>
</body>
</html>
